sbox:
        .string "c|w{\362ko\3050\001g+\376\327\253v\312\202\311}\372YG\360\255\324\242\257\234\244r\300\267\375\223&6?\367\3144\245\345\361q\3301\025\004\307#\303\030\226\005\232\007\022\200\342\353'\262u\t\203,\032\033nZ\240R;\326\263)\343/\204S\321"
        .ascii  "\355 \374\261[j\313\2769JLX\317\320\357\252\373CM3\205E\371\002"
        .ascii  "\177P<\237\250Q\243@\217\222\2358\365\274\266\332!\020\377\363"
        .ascii  "\322\315\f\023\354_\227D\027\304\247~=d]\031s`\201O\334\"*\220"
        .ascii  "\210F\356\270\024\336^\013\333\3402:\nI\006$\\\302\323\254b\221"
        .ascii  "\225\344y\347\3107m\215\325N\251lV\364\352ez\256\b\272x%.\034"
        .ascii  "\246\264\306\350\335t\037K\275\213\212p>\265fH\003\366\016a5"
        .ascii  "W\271\206\301\035\236\341\370\230\021i\331\216\224\233\036\207"
        .ascii  "\351\316U(\337\214\241\211\r\277\346BhA\231-\017\260T\273\026"
rsbox:
        .string "R\tj\32506\2458\277@\243\236\201\363\327\373|\3439\202\233/\377\2074\216CD\304\336\351\313T{\2242\246\302#=\356L\225\013B\372\303N\b.\241f(\331$\262v[\242Im\213\321%r\370\366d\206h\230\026\324\244\\\314]e\266\222lpHP\375\355\271\332^\025FW\247\215\235\204\220\330\253"
        .ascii  "\214\274\323\n\367\344X\005\270\263E\006\320,\036\217\312?\017"
        .ascii  "\002\301\257\275\003\001\023\212k:\221\021AOg\334\352\227\362"
        .ascii  "\317\316\360\264\346s\226\254t\"\347\2555\205\342\3717\350\034"
        .ascii  "u\337nG\361\032q\035)\305\211o\267b\016\252\030\276\033\374V"
        .ascii  ">K\306\322y \232\333\300\376x\315Z\364\037\335\2503\210\007\307"
        .ascii  "1\261\022\020Y'\200\354_`Q\177\251\031\265J\r-\345z\237\223\311"
        .ascii  "\234\357\240\340;M\256*\365\260\310\353\273<\203S\231a\027+\004"
        .ascii  "~\272w\326&\341i\024cU!\f}"
Rcon:
        .ascii  "\215\001\002\004\b\020 @\200\0336"
KeyExpansion:
        addi    sp,sp,-64
        sw      s0,60(sp)
        addi    s0,sp,64
        sw      a0,-52(s0)
        sw      a1,-56(s0)
        sw      zero,-20(s0)
        j       .L2
.L3:
        lw      a5,-20(s0)
        slli    a5,a5,2
        lw      a4,-56(s0)
        add     a4,a4,a5
        lw      a5,-20(s0)
        slli    a5,a5,2
        lw      a3,-52(s0)
        add     a5,a3,a5
        lbu     a4,0(a4)
        sb      a4,0(a5)
        lw      a5,-20(s0)
        slli    a5,a5,2
        addi    a5,a5,1
        lw      a4,-56(s0)
        add     a4,a4,a5
        lw      a5,-20(s0)
        slli    a5,a5,2
        addi    a5,a5,1
        lw      a3,-52(s0)
        add     a5,a3,a5
        lbu     a4,0(a4)
        sb      a4,0(a5)
        lw      a5,-20(s0)
        slli    a5,a5,2
        addi    a5,a5,2
        lw      a4,-56(s0)
        add     a4,a4,a5
        lw      a5,-20(s0)
        slli    a5,a5,2
        addi    a5,a5,2
        lw      a3,-52(s0)
        add     a5,a3,a5
        lbu     a4,0(a4)
        sb      a4,0(a5)
        lw      a5,-20(s0)
        slli    a5,a5,2
        addi    a5,a5,3
        lw      a4,-56(s0)
        add     a4,a4,a5
        lw      a5,-20(s0)
        slli    a5,a5,2
        addi    a5,a5,3
        lw      a3,-52(s0)
        add     a5,a3,a5
        lbu     a4,0(a4)
        sb      a4,0(a5)
        lw      a5,-20(s0)
        addi    a5,a5,1
        sw      a5,-20(s0)
.L2:
        lw      a4,-20(s0)
        li      a5,3
        bleu    a4,a5,.L3
        li      a5,4
        sw      a5,-20(s0)
        j       .L4
.L6:
        lw      a5,-20(s0)
        addi    a5,a5,-1
        slli    a5,a5,2
        sw      a5,-24(s0)
        lw      a4,-52(s0)
        lw      a5,-24(s0)
        add     a5,a4,a5
        lbu     a5,0(a5)
        sb      a5,-36(s0)
        lw      a5,-24(s0)
        addi    a5,a5,1
        lw      a4,-52(s0)
        add     a5,a4,a5
        lbu     a5,0(a5)
        sb      a5,-35(s0)
        lw      a5,-24(s0)
        addi    a5,a5,2
        lw      a4,-52(s0)
        add     a5,a4,a5
        lbu     a5,0(a5)
        sb      a5,-34(s0)
        lw      a5,-24(s0)
        addi    a5,a5,3
        lw      a4,-52(s0)
        add     a5,a4,a5
        lbu     a5,0(a5)
        sb      a5,-33(s0)
        lw      a5,-20(s0)
        andi    a5,a5,3
        bne     a5,zero,.L5
        lbu     a5,-36(s0)
        sb      a5,-25(s0)
        lbu     a5,-35(s0)
        sb      a5,-36(s0)
        lbu     a5,-34(s0)
        sb      a5,-35(s0)
        lbu     a5,-33(s0)
        sb      a5,-34(s0)
        lbu     a5,-25(s0)
        sb      a5,-33(s0)
        lbu     a5,-36(s0)
        mv      a4,a5
        lui     a5,%hi(sbox)
        addi    a5,a5,%lo(sbox)
        add     a5,a5,a4
        lbu     a5,0(a5)
        sb      a5,-36(s0)
        lbu     a5,-35(s0)
        mv      a4,a5
        lui     a5,%hi(sbox)
        addi    a5,a5,%lo(sbox)
        add     a5,a5,a4
        lbu     a5,0(a5)
        sb      a5,-35(s0)
        lbu     a5,-34(s0)
        mv      a4,a5
        lui     a5,%hi(sbox)
        addi    a5,a5,%lo(sbox)
        add     a5,a5,a4
        lbu     a5,0(a5)
        sb      a5,-34(s0)
        lbu     a5,-33(s0)
        mv      a4,a5
        lui     a5,%hi(sbox)
        addi    a5,a5,%lo(sbox)
        add     a5,a5,a4
        lbu     a5,0(a5)
        sb      a5,-33(s0)
        lbu     a4,-36(s0)
        lw      a5,-20(s0)
        srli    a5,a5,2
        lui     a3,%hi(Rcon)
        addi    a3,a3,%lo(Rcon)
        add     a5,a3,a5
        lbu     a5,0(a5)
        xor     a5,a4,a5
        andi    a5,a5,0xff
        sb      a5,-36(s0)
.L5:
        lw      a5,-20(s0)
        slli    a5,a5,2
        sw      a5,-32(s0)
        lw      a5,-20(s0)
        addi    a5,a5,-4
        slli    a5,a5,2
        sw      a5,-24(s0)
        lw      a4,-52(s0)
        lw      a5,-24(s0)
        add     a5,a4,a5
        lbu     a3,0(a5)
        lbu     a4,-36(s0)
        lw      a2,-52(s0)
        lw      a5,-32(s0)
        add     a5,a2,a5
        xor     a4,a3,a4
        andi    a4,a4,0xff
        sb      a4,0(a5)
        lw      a5,-24(s0)
        addi    a5,a5,1
        lw      a4,-52(s0)
        add     a5,a4,a5
        lbu     a3,0(a5)
        lbu     a4,-35(s0)
        lw      a5,-32(s0)
        addi    a5,a5,1
        lw      a2,-52(s0)
        add     a5,a2,a5
        xor     a4,a3,a4
        andi    a4,a4,0xff
        sb      a4,0(a5)
        lw      a5,-24(s0)
        addi    a5,a5,2
        lw      a4,-52(s0)
        add     a5,a4,a5
        lbu     a3,0(a5)
        lbu     a4,-34(s0)
        lw      a5,-32(s0)
        addi    a5,a5,2
        lw      a2,-52(s0)
        add     a5,a2,a5
        xor     a4,a3,a4
        andi    a4,a4,0xff
        sb      a4,0(a5)
        lw      a5,-24(s0)
        addi    a5,a5,3
        lw      a4,-52(s0)
        add     a5,a4,a5
        lbu     a3,0(a5)
        lbu     a4,-33(s0)
        lw      a5,-32(s0)
        addi    a5,a5,3
        lw      a2,-52(s0)
        add     a5,a2,a5
        xor     a4,a3,a4
        andi    a4,a4,0xff
        sb      a4,0(a5)
        lw      a5,-20(s0)
        addi    a5,a5,1
        sw      a5,-20(s0)
.L4:
        lw      a4,-20(s0)
        li      a5,43
        bleu    a4,a5,.L6
        nop
        nop
        lw      s0,60(sp)
        addi    sp,sp,64
        jr      ra
AES_init_ctx:
        addi    sp,sp,-32
        sw      ra,28(sp)
        sw      s0,24(sp)
        addi    s0,sp,32
        sw      a0,-20(s0)
        sw      a1,-24(s0)
        lw      a5,-20(s0)
        lw      a1,-24(s0)
        mv      a0,a5
        call    KeyExpansion
        nop
        lw      ra,28(sp)
        lw      s0,24(sp)
        addi    sp,sp,32
        jr      ra
AES_init_ctx_iv:
        addi    sp,sp,-32
        sw      ra,28(sp)
        sw      s0,24(sp)
        addi    s0,sp,32
        sw      a0,-20(s0)
        sw      a1,-24(s0)
        sw      a2,-28(s0)
        lw      a5,-20(s0)
        lw      a1,-24(s0)
        mv      a0,a5
        call    KeyExpansion
        lw      a5,-20(s0)
        addi    a5,a5,176
        li      a2,16
        lw      a1,-28(s0)
        mv      a0,a5
        call    memcpy
        nop
        lw      ra,28(sp)
        lw      s0,24(sp)
        addi    sp,sp,32
        jr      ra
AES_ctx_set_iv:
        addi    sp,sp,-32
        sw      ra,28(sp)
        sw      s0,24(sp)
        addi    s0,sp,32
        sw      a0,-20(s0)
        sw      a1,-24(s0)
        lw      a5,-20(s0)
        addi    a5,a5,176
        li      a2,16
        lw      a1,-24(s0)
        mv      a0,a5
        call    memcpy
        nop
        lw      ra,28(sp)
        lw      s0,24(sp)
        addi    sp,sp,32
        jr      ra
AddRoundKey:
        addi    sp,sp,-48
        sw      s0,44(sp)
        addi    s0,sp,48
        mv      a5,a0
        sw      a1,-40(s0)
        sw      a2,-44(s0)
        sb      a5,-33(s0)
        sb      zero,-17(s0)
        j       .L11
.L14:
        sb      zero,-18(s0)
        j       .L12
.L13:
        lbu     a4,-17(s0)
        lbu     a5,-18(s0)
        lw      a3,-40(s0)
        slli    a4,a4,2
        add     a4,a3,a4
        add     a5,a4,a5
        lbu     a2,0(a5)
        lbu     a5,-33(s0)
        slli    a4,a5,2
        lbu     a5,-17(s0)
        add     a5,a4,a5
        slli    a4,a5,2
        lbu     a5,-18(s0)
        add     a5,a4,a5
        mv      a4,a5
        lw      a5,-44(s0)
        add     a5,a5,a4
        lbu     a4,0(a5)
        lbu     a3,-17(s0)
        lbu     a5,-18(s0)
        xor     a4,a2,a4
        andi    a4,a4,0xff
        lw      a2,-40(s0)
        slli    a3,a3,2
        add     a3,a2,a3
        add     a5,a3,a5
        sb      a4,0(a5)
        lbu     a5,-18(s0)
        addi    a5,a5,1
        sb      a5,-18(s0)
.L12:
        lbu     a4,-18(s0)
        li      a5,3
        bleu    a4,a5,.L13
        lbu     a5,-17(s0)
        addi    a5,a5,1
        sb      a5,-17(s0)
.L11:
        lbu     a4,-17(s0)
        li      a5,3
        bleu    a4,a5,.L14
        nop
        nop
        lw      s0,44(sp)
        addi    sp,sp,48
        jr      ra
SubBytes:
        addi    sp,sp,-48
        sw      s0,44(sp)
        addi    s0,sp,48
        sw      a0,-36(s0)
        sb      zero,-17(s0)
        j       .L16
.L19:
        sb      zero,-18(s0)
        j       .L17
.L18:
        lbu     a4,-18(s0)
        lbu     a5,-17(s0)
        lw      a3,-36(s0)
        slli    a4,a4,2
        add     a4,a3,a4
        add     a5,a4,a5
        lbu     a5,0(a5)
        mv      a2,a5
        lbu     a3,-18(s0)
        lbu     a5,-17(s0)
        lui     a4,%hi(sbox)
        addi    a4,a4,%lo(sbox)
        add     a4,a4,a2
        lbu     a4,0(a4)
        lw      a2,-36(s0)
        slli    a3,a3,2
        add     a3,a2,a3
        add     a5,a3,a5
        sb      a4,0(a5)
        lbu     a5,-18(s0)
        addi    a5,a5,1
        sb      a5,-18(s0)
.L17:
        lbu     a4,-18(s0)
        li      a5,3
        bleu    a4,a5,.L18
        lbu     a5,-17(s0)
        addi    a5,a5,1
        sb      a5,-17(s0)
.L16:
        lbu     a4,-17(s0)
        li      a5,3
        bleu    a4,a5,.L19
        nop
        nop
        lw      s0,44(sp)
        addi    sp,sp,48
        jr      ra
ShiftRows:
        addi    sp,sp,-48
        sw      s0,44(sp)
        addi    s0,sp,48
        sw      a0,-36(s0)
        lw      a5,-36(s0)
        lbu     a5,1(a5)
        sb      a5,-17(s0)
        lw      a5,-36(s0)
        lbu     a4,5(a5)
        lw      a5,-36(s0)
        sb      a4,1(a5)
        lw      a5,-36(s0)
        lbu     a4,9(a5)
        lw      a5,-36(s0)
        sb      a4,5(a5)
        lw      a5,-36(s0)
        lbu     a4,13(a5)
        lw      a5,-36(s0)
        sb      a4,9(a5)
        lw      a5,-36(s0)
        lbu     a4,-17(s0)
        sb      a4,13(a5)
        lw      a5,-36(s0)
        lbu     a5,2(a5)
        sb      a5,-17(s0)
        lw      a5,-36(s0)
        lbu     a4,10(a5)
        lw      a5,-36(s0)
        sb      a4,2(a5)
        lw      a5,-36(s0)
        lbu     a4,-17(s0)
        sb      a4,10(a5)
        lw      a5,-36(s0)
        lbu     a5,6(a5)
        sb      a5,-17(s0)
        lw      a5,-36(s0)
        lbu     a4,14(a5)
        lw      a5,-36(s0)
        sb      a4,6(a5)
        lw      a5,-36(s0)
        lbu     a4,-17(s0)
        sb      a4,14(a5)
        lw      a5,-36(s0)
        lbu     a5,3(a5)
        sb      a5,-17(s0)
        lw      a5,-36(s0)
        lbu     a4,15(a5)
        lw      a5,-36(s0)
        sb      a4,3(a5)
        lw      a5,-36(s0)
        lbu     a4,11(a5)
        lw      a5,-36(s0)
        sb      a4,15(a5)
        lw      a5,-36(s0)
        lbu     a4,7(a5)
        lw      a5,-36(s0)
        sb      a4,11(a5)
        lw      a5,-36(s0)
        lbu     a4,-17(s0)
        sb      a4,7(a5)
        nop
        lw      s0,44(sp)
        addi    sp,sp,48
        jr      ra
xtime:
        addi    sp,sp,-32
        sw      s0,28(sp)
        addi    s0,sp,32
        mv      a5,a0
        sb      a5,-17(s0)
        lb      a5,-17(s0)
        slli    a5,a5,1
        slli    a3,a5,24
        srai    a3,a3,24
        lbu     a5,-17(s0)
        srli    a5,a5,7
        andi    a5,a5,0xff
        slli    a5,a5,24
        srai    a5,a5,24
        mv      a4,a5
        slli    a4,a4,3
        sub     a4,a4,a5
        slli    a4,a4,2
        sub     a5,a4,a5
        slli    a5,a5,24
        srai    a5,a5,24
        xor     a5,a3,a5
        slli    a5,a5,24
        srai    a5,a5,24
        andi    a5,a5,0xff
        mv      a0,a5
        lw      s0,28(sp)
        addi    sp,sp,32
        jr      ra
MixColumns:
        addi    sp,sp,-48
        sw      ra,44(sp)
        sw      s0,40(sp)
        addi    s0,sp,48
        sw      a0,-36(s0)
        sb      zero,-17(s0)
        j       .L24
.L25:
        lbu     a5,-17(s0)
        lw      a4,-36(s0)
        slli    a5,a5,2
        add     a5,a4,a5
        lbu     a5,0(a5)
        sb      a5,-18(s0)
        lbu     a5,-17(s0)
        lw      a4,-36(s0)
        slli    a5,a5,2
        add     a5,a4,a5
        lbu     a4,0(a5)
        lbu     a5,-17(s0)
        lw      a3,-36(s0)
        slli    a5,a5,2
        add     a5,a3,a5
        lbu     a5,1(a5)
        xor     a5,a4,a5
        andi    a4,a5,0xff
        lbu     a5,-17(s0)
        lw      a3,-36(s0)
        slli    a5,a5,2
        add     a5,a3,a5
        lbu     a5,2(a5)
        xor     a5,a4,a5
        andi    a4,a5,0xff
        lbu     a5,-17(s0)
        lw      a3,-36(s0)
        slli    a5,a5,2
        add     a5,a3,a5
        lbu     a5,3(a5)
        xor     a5,a4,a5
        sb      a5,-19(s0)
        lbu     a5,-17(s0)
        lw      a4,-36(s0)
        slli    a5,a5,2
        add     a5,a4,a5
        lbu     a4,0(a5)
        lbu     a5,-17(s0)
        lw      a3,-36(s0)
        slli    a5,a5,2
        add     a5,a3,a5
        lbu     a5,1(a5)
        xor     a5,a4,a5
        sb      a5,-20(s0)
        lbu     a5,-20(s0)
        mv      a0,a5
        call    xtime
        mv      a5,a0
        sb      a5,-20(s0)
        lbu     a5,-17(s0)
        lw      a4,-36(s0)
        slli    a5,a5,2
        add     a5,a4,a5
        lbu     a3,0(a5)
        lbu     a5,-20(s0)
        mv      a4,a5
        lbu     a5,-19(s0)
        xor     a5,a4,a5
        andi    a4,a5,0xff
        lbu     a5,-17(s0)
        xor     a4,a3,a4
        andi    a4,a4,0xff
        lw      a3,-36(s0)
        slli    a5,a5,2
        add     a5,a3,a5
        sb      a4,0(a5)
        lbu     a5,-17(s0)
        lw      a4,-36(s0)
        slli    a5,a5,2
        add     a5,a4,a5
        lbu     a4,1(a5)
        lbu     a5,-17(s0)
        lw      a3,-36(s0)
        slli    a5,a5,2
        add     a5,a3,a5
        lbu     a5,2(a5)
        xor     a5,a4,a5
        sb      a5,-20(s0)
        lbu     a5,-20(s0)
        mv      a0,a5
        call    xtime
        mv      a5,a0
        sb      a5,-20(s0)
        lbu     a5,-17(s0)
        lw      a4,-36(s0)
        slli    a5,a5,2
        add     a5,a4,a5
        lbu     a3,1(a5)
        lbu     a5,-20(s0)
        mv      a4,a5
        lbu     a5,-19(s0)
        xor     a5,a4,a5
        andi    a4,a5,0xff
        lbu     a5,-17(s0)
        xor     a4,a3,a4
        andi    a4,a4,0xff
        lw      a3,-36(s0)
        slli    a5,a5,2
        add     a5,a3,a5
        sb      a4,1(a5)
        lbu     a5,-17(s0)
        lw      a4,-36(s0)
        slli    a5,a5,2
        add     a5,a4,a5
        lbu     a4,2(a5)
        lbu     a5,-17(s0)
        lw      a3,-36(s0)
        slli    a5,a5,2
        add     a5,a3,a5
        lbu     a5,3(a5)
        xor     a5,a4,a5
        sb      a5,-20(s0)
        lbu     a5,-20(s0)
        mv      a0,a5
        call    xtime
        mv      a5,a0
        sb      a5,-20(s0)
        lbu     a5,-17(s0)
        lw      a4,-36(s0)
        slli    a5,a5,2
        add     a5,a4,a5
        lbu     a3,2(a5)
        lbu     a5,-20(s0)
        mv      a4,a5
        lbu     a5,-19(s0)
        xor     a5,a4,a5
        andi    a4,a5,0xff
        lbu     a5,-17(s0)
        xor     a4,a3,a4
        andi    a4,a4,0xff
        lw      a3,-36(s0)
        slli    a5,a5,2
        add     a5,a3,a5
        sb      a4,2(a5)
        lbu     a5,-17(s0)
        lw      a4,-36(s0)
        slli    a5,a5,2
        add     a5,a4,a5
        lbu     a5,3(a5)
        lbu     a4,-18(s0)
        xor     a5,a5,a4
        sb      a5,-20(s0)
        lbu     a5,-20(s0)
        mv      a0,a5
        call    xtime
        mv      a5,a0
        sb      a5,-20(s0)
        lbu     a5,-17(s0)
        lw      a4,-36(s0)
        slli    a5,a5,2
        add     a5,a4,a5
        lbu     a3,3(a5)
        lbu     a5,-20(s0)
        mv      a4,a5
        lbu     a5,-19(s0)
        xor     a5,a4,a5
        andi    a4,a5,0xff
        lbu     a5,-17(s0)
        xor     a4,a3,a4
        andi    a4,a4,0xff
        lw      a3,-36(s0)
        slli    a5,a5,2
        add     a5,a3,a5
        sb      a4,3(a5)
        lbu     a5,-17(s0)
        addi    a5,a5,1
        sb      a5,-17(s0)
.L24:
        lbu     a4,-17(s0)
        li      a5,3
        bleu    a4,a5,.L25
        nop
        nop
        lw      ra,44(sp)
        lw      s0,40(sp)
        addi    sp,sp,48
        jr      ra
InvMixColumns:
        addi    sp,sp,-48
        sw      ra,44(sp)
        sw      s0,40(sp)
        sw      s1,36(sp)
        sw      s2,32(sp)
        addi    s0,sp,48
        sw      a0,-36(s0)
        sw      zero,-20(s0)
        j       .L27
.L28:
        lw      a4,-36(s0)
        lw      a5,-20(s0)
        slli    a5,a5,2
        add     a5,a4,a5
        lbu     a5,0(a5)
        sb      a5,-21(s0)
        lw      a4,-36(s0)
        lw      a5,-20(s0)
        slli    a5,a5,2
        add     a5,a4,a5
        lbu     a5,1(a5)
        sb      a5,-22(s0)
        lw      a4,-36(s0)
        lw      a5,-20(s0)
        slli    a5,a5,2
        add     a5,a4,a5
        lbu     a5,2(a5)
        sb      a5,-23(s0)
        lw      a4,-36(s0)
        lw      a5,-20(s0)
        slli    a5,a5,2
        add     a5,a4,a5
        lbu     a5,3(a5)
        sb      a5,-24(s0)
        lbu     a5,-21(s0)
        mv      a0,a5
        call    xtime
        mv      a5,a0
        mv      a0,a5
        call    xtime
        mv      a5,a0
        mv      a0,a5
        call    xtime
        mv      a5,a0
        mv      a0,a5
        call    xtime
        lbu     a5,-22(s0)
        mv      a0,a5
        call    xtime
        mv      a5,a0
        mv      a0,a5
        call    xtime
        lbu     a5,-22(s0)
        mv      a0,a5
        call    xtime
        mv      a5,a0
        mv      a0,a5
        call    xtime
        mv      a5,a0
        mv      a0,a5
        call    xtime
        mv      a5,a0
        mv      a0,a5
        call    xtime
        lbu     a5,-23(s0)
        mv      a0,a5
        call    xtime
        lbu     a5,-23(s0)
        mv      a0,a5
        call    xtime
        mv      a5,a0
        mv      a0,a5
        call    xtime
        mv      a5,a0
        mv      a0,a5
        call    xtime
        mv      a5,a0
        mv      a0,a5
        call    xtime
        lbu     a5,-24(s0)
        mv      a0,a5
        call    xtime
        lbu     a5,-24(s0)
        mv      a0,a5
        call    xtime
        mv      a5,a0
        mv      a0,a5
        call    xtime
        lbu     a5,-24(s0)
        mv      a0,a5
        call    xtime
        mv      a5,a0
        mv      a0,a5
        call    xtime
        mv      a5,a0
        mv      a0,a5
        call    xtime
        mv      a5,a0
        mv      a0,a5
        call    xtime
        lbu     a5,-21(s0)
        mv      a0,a5
        call    xtime
        mv      a5,a0
        mv      s1,a5
        lbu     a5,-21(s0)
        mv      a0,a5
        call    xtime
        mv      a5,a0
        mv      a0,a5
        call    xtime
        mv      a5,a0
        xor     a5,s1,a5
        andi    s1,a5,0xff
        lbu     a5,-21(s0)
        mv      a0,a5
        call    xtime
        mv      a5,a0
        mv      a0,a5
        call    xtime
        mv      a5,a0
        mv      a0,a5
        call    xtime
        mv      a5,a0
        xor     a5,s1,a5
        andi    s1,a5,0xff
        lbu     a5,-22(s0)
        mv      a0,a5
        call    xtime
        mv      a5,a0
        mv      a4,a5
        lbu     a5,-22(s0)
        xor     a5,a4,a5
        andi    s2,a5,0xff
        lbu     a5,-22(s0)
        mv      a0,a5
        call    xtime
        mv      a5,a0
        mv      a0,a5
        call    xtime
        mv      a5,a0
        mv      a0,a5
        call    xtime
        mv      a5,a0
        xor     a5,s2,a5
        andi    a5,a5,0xff
        xor     a5,s1,a5
        andi    s1,a5,0xff
        lbu     a5,-23(s0)
        mv      a0,a5
        call    xtime
        mv      a5,a0
        mv      a0,a5
        call    xtime
        mv      a5,a0
        mv      a4,a5
        lbu     a5,-23(s0)
        xor     a5,a4,a5
        andi    s2,a5,0xff
        lbu     a5,-23(s0)
        mv      a0,a5
        call    xtime
        mv      a5,a0
        mv      a0,a5
        call    xtime
        mv      a5,a0
        mv      a0,a5
        call    xtime
        mv      a5,a0
        xor     a5,s2,a5
        andi    a5,a5,0xff
        xor     a5,s1,a5
        andi    s1,a5,0xff
        lbu     a5,-24(s0)
        mv      a0,a5
        call    xtime
        mv      a5,a0
        mv      a0,a5
        call    xtime
        mv      a5,a0
        mv      a0,a5
        call    xtime
        mv      a5,a0
        mv      a4,a5
        lbu     a5,-24(s0)
        xor     a5,a4,a5
        andi    a5,a5,0xff
        xor     a5,s1,a5
        andi    a4,a5,0xff
        lw      a3,-36(s0)
        lw      a5,-20(s0)
        slli    a5,a5,2
        add     a5,a3,a5
        sb      a4,0(a5)
        lbu     a5,-21(s0)
        mv      a0,a5
        call    xtime
        lbu     a5,-21(s0)
        mv      a0,a5
        call    xtime
        mv      a5,a0
        mv      a0,a5
        call    xtime
        lbu     a5,-21(s0)
        mv      a0,a5
        call    xtime
        mv      a5,a0
        mv      a0,a5
        call    xtime
        mv      a5,a0
        mv      a0,a5
        call    xtime
        mv      a5,a0
        mv      a0,a5
        call    xtime
        lbu     a5,-22(s0)
        mv      a0,a5
        call    xtime
        mv      a5,a0
        mv      a0,a5
        call    xtime
        mv      a5,a0
        mv      a0,a5
        call    xtime
        mv      a5,a0
        mv      a0,a5
        call    xtime
        lbu     a5,-23(s0)
        mv      a0,a5
        call    xtime
        mv      a5,a0
        mv      a0,a5
        call    xtime
        lbu     a5,-23(s0)
        mv      a0,a5
        call    xtime
        mv      a5,a0
        mv      a0,a5
        call    xtime
        mv      a5,a0
        mv      a0,a5
        call    xtime
        mv      a5,a0
        mv      a0,a5
        call    xtime
        lbu     a5,-24(s0)
        mv      a0,a5
        call    xtime
        lbu     a5,-24(s0)
        mv      a0,a5
        call    xtime
        mv      a5,a0
        mv      a0,a5
        call    xtime
        mv      a5,a0
        mv      a0,a5
        call    xtime
        mv      a5,a0
        mv      a0,a5
        call    xtime
        lbu     a5,-21(s0)
        mv      a0,a5
        call    xtime
        mv      a5,a0
        mv      a0,a5
        call    xtime
        mv      a5,a0
        mv      a0,a5
        call    xtime
        mv      a5,a0
        mv      a4,a5
        lbu     a5,-21(s0)
        xor     a5,a4,a5
        andi    s1,a5,0xff
        lbu     a5,-22(s0)
        mv      a0,a5
        call    xtime
        mv      a5,a0
        mv      s2,a5
        lbu     a5,-22(s0)
        mv      a0,a5
        call    xtime
        mv      a5,a0
        mv      a0,a5
        call    xtime
        mv      a5,a0
        xor     a5,s2,a5
        andi    s2,a5,0xff
        lbu     a5,-22(s0)
        mv      a0,a5
        call    xtime
        mv      a5,a0
        mv      a0,a5
        call    xtime
        mv      a5,a0
        mv      a0,a5
        call    xtime
        mv      a5,a0
        xor     a5,s2,a5
        andi    a5,a5,0xff
        xor     a5,s1,a5
        andi    s1,a5,0xff
        lbu     a5,-23(s0)
        mv      a0,a5
        call    xtime
        mv      a5,a0
        mv      a4,a5
        lbu     a5,-23(s0)
        xor     a5,a4,a5
        andi    s2,a5,0xff
        lbu     a5,-23(s0)
        mv      a0,a5
        call    xtime
        mv      a5,a0
        mv      a0,a5
        call    xtime
        mv      a5,a0
        mv      a0,a5
        call    xtime
        mv      a5,a0
        xor     a5,s2,a5
        andi    a5,a5,0xff
        xor     a5,s1,a5
        andi    s1,a5,0xff
        lbu     a5,-24(s0)
        mv      a0,a5
        call    xtime
        mv      a5,a0
        mv      a0,a5
        call    xtime
        mv      a5,a0
        mv      a4,a5
        lbu     a5,-24(s0)
        xor     a5,a4,a5
        andi    s2,a5,0xff
        lbu     a5,-24(s0)
        mv      a0,a5
        call    xtime
        mv      a5,a0
        mv      a0,a5
        call    xtime
        mv      a5,a0
        mv      a0,a5
        call    xtime
        mv      a5,a0
        xor     a5,s2,a5
        andi    a5,a5,0xff
        xor     a5,s1,a5
        andi    a4,a5,0xff
        lw      a3,-36(s0)
        lw      a5,-20(s0)
        slli    a5,a5,2
        add     a5,a3,a5
        sb      a4,1(a5)
        lbu     a5,-21(s0)
        mv      a0,a5
        call    xtime
        lbu     a5,-21(s0)
        mv      a0,a5
        call    xtime
        mv      a5,a0
        mv      a0,a5
        call    xtime
        mv      a5,a0
        mv      a0,a5
        call    xtime
        mv      a5,a0
        mv      a0,a5
        call    xtime
        lbu     a5,-22(s0)
        mv      a0,a5
        call    xtime
        lbu     a5,-22(s0)
        mv      a0,a5
        call    xtime
        mv      a5,a0
        mv      a0,a5
        call    xtime
        lbu     a5,-22(s0)
        mv      a0,a5
        call    xtime
        mv      a5,a0
        mv      a0,a5
        call    xtime
        mv      a5,a0
        mv      a0,a5
        call    xtime
        mv      a5,a0
        mv      a0,a5
        call    xtime
        lbu     a5,-23(s0)
        mv      a0,a5
        call    xtime
        mv      a5,a0
        mv      a0,a5
        call    xtime
        mv      a5,a0
        mv      a0,a5
        call    xtime
        mv      a5,a0
        mv      a0,a5
        call    xtime
        lbu     a5,-24(s0)
        mv      a0,a5
        call    xtime
        mv      a5,a0
        mv      a0,a5
        call    xtime
        lbu     a5,-24(s0)
        mv      a0,a5
        call    xtime
        mv      a5,a0
        mv      a0,a5
        call    xtime
        mv      a5,a0
        mv      a0,a5
        call    xtime
        mv      a5,a0
        mv      a0,a5
        call    xtime
        lbu     a5,-21(s0)
        mv      a0,a5
        call    xtime
        mv      a5,a0
        mv      a0,a5
        call    xtime
        mv      a5,a0
        mv      a4,a5
        lbu     a5,-21(s0)
        xor     a5,a4,a5
        andi    s1,a5,0xff
        lbu     a5,-21(s0)
        mv      a0,a5
        call    xtime
        mv      a5,a0
        mv      a0,a5
        call    xtime
        mv      a5,a0
        mv      a0,a5
        call    xtime
        mv      a5,a0
        xor     a5,s1,a5
        andi    s1,a5,0xff
        lbu     a5,-22(s0)
        mv      a0,a5
        call    xtime
        mv      a5,a0
        mv      a0,a5
        call    xtime
        mv      a5,a0
        mv      a0,a5
        call    xtime
        mv      a5,a0
        mv      a4,a5
        lbu     a5,-22(s0)
        xor     a5,a4,a5
        andi    a5,a5,0xff
        xor     a5,s1,a5
        andi    s1,a5,0xff
        lbu     a5,-23(s0)
        mv      a0,a5
        call    xtime
        mv      a5,a0
        mv      s2,a5
        lbu     a5,-23(s0)
        mv      a0,a5
        call    xtime
        mv      a5,a0
        mv      a0,a5
        call    xtime
        mv      a5,a0
        xor     a5,s2,a5
        andi    s2,a5,0xff
        lbu     a5,-23(s0)
        mv      a0,a5
        call    xtime
        mv      a5,a0
        mv      a0,a5
        call    xtime
        mv      a5,a0
        mv      a0,a5
        call    xtime
        mv      a5,a0
        xor     a5,s2,a5
        andi    a5,a5,0xff
        xor     a5,s1,a5
        andi    s1,a5,0xff
        lbu     a5,-24(s0)
        mv      a0,a5
        call    xtime
        mv      a5,a0
        mv      a4,a5
        lbu     a5,-24(s0)
        xor     a5,a4,a5
        andi    s2,a5,0xff
        lbu     a5,-24(s0)
        mv      a0,a5
        call    xtime
        mv      a5,a0
        mv      a0,a5
        call    xtime
        mv      a5,a0
        mv      a0,a5
        call    xtime
        mv      a5,a0
        xor     a5,s2,a5
        andi    a5,a5,0xff
        xor     a5,s1,a5
        andi    a4,a5,0xff
        lw      a3,-36(s0)
        lw      a5,-20(s0)
        slli    a5,a5,2
        add     a5,a3,a5
        sb      a4,2(a5)
        lbu     a5,-21(s0)
        mv      a0,a5
        call    xtime
        mv      a5,a0
        mv      a0,a5
        call    xtime
        lbu     a5,-21(s0)
        mv      a0,a5
        call    xtime
        mv      a5,a0
        mv      a0,a5
        call    xtime
        mv      a5,a0
        mv      a0,a5
        call    xtime
        mv      a5,a0
        mv      a0,a5
        call    xtime
        lbu     a5,-22(s0)
        mv      a0,a5
        call    xtime
        lbu     a5,-22(s0)
        mv      a0,a5
        call    xtime
        mv      a5,a0
        mv      a0,a5
        call    xtime
        mv      a5,a0
        mv      a0,a5
        call    xtime
        mv      a5,a0
        mv      a0,a5
        call    xtime
        lbu     a5,-23(s0)
        mv      a0,a5
        call    xtime
        lbu     a5,-23(s0)
        mv      a0,a5
        call    xtime
        mv      a5,a0
        mv      a0,a5
        call    xtime
        lbu     a5,-23(s0)
        mv      a0,a5
        call    xtime
        mv      a5,a0
        mv      a0,a5
        call    xtime
        mv      a5,a0
        mv      a0,a5
        call    xtime
        mv      a5,a0
        mv      a0,a5
        call    xtime
        lbu     a5,-24(s0)
        mv      a0,a5
        call    xtime
        mv      a5,a0
        mv      a0,a5
        call    xtime
        mv      a5,a0
        mv      a0,a5
        call    xtime
        mv      a5,a0
        mv      a0,a5
        call    xtime
        lbu     a5,-21(s0)
        mv      a0,a5
        call    xtime
        mv      a5,a0
        mv      a4,a5
        lbu     a5,-21(s0)
        xor     a5,a4,a5
        andi    s1,a5,0xff
        lbu     a5,-21(s0)
        mv      a0,a5
        call    xtime
        mv      a5,a0
        mv      a0,a5
        call    xtime
        mv      a5,a0
        mv      a0,a5
        call    xtime
        mv      a5,a0
        xor     a5,s1,a5
        andi    s1,a5,0xff
        lbu     a5,-22(s0)
        mv      a0,a5
        call    xtime
        mv      a5,a0
        mv      a0,a5
        call    xtime
        mv      a5,a0
        mv      a4,a5
        lbu     a5,-22(s0)
        xor     a5,a4,a5
        andi    s2,a5,0xff
        lbu     a5,-22(s0)
        mv      a0,a5
        call    xtime
        mv      a5,a0
        mv      a0,a5
        call    xtime
        mv      a5,a0
        mv      a0,a5
        call    xtime
        mv      a5,a0
        xor     a5,s2,a5
        andi    a5,a5,0xff
        xor     a5,s1,a5
        andi    s1,a5,0xff
        lbu     a5,-23(s0)
        mv      a0,a5
        call    xtime
        mv      a5,a0
        mv      a0,a5
        call    xtime
        mv      a5,a0
        mv      a0,a5
        call    xtime
        mv      a5,a0
        mv      a4,a5
        lbu     a5,-23(s0)
        xor     a5,a4,a5
        andi    a5,a5,0xff
        xor     a5,s1,a5
        andi    s1,a5,0xff
        lbu     a5,-24(s0)
        mv      a0,a5
        call    xtime
        mv      a5,a0
        mv      s2,a5
        lbu     a5,-24(s0)
        mv      a0,a5
        call    xtime
        mv      a5,a0
        mv      a0,a5
        call    xtime
        mv      a5,a0
        xor     a5,s2,a5
        andi    s2,a5,0xff
        lbu     a5,-24(s0)
        mv      a0,a5
        call    xtime
        mv      a5,a0
        mv      a0,a5
        call    xtime
        mv      a5,a0
        mv      a0,a5
        call    xtime
        mv      a5,a0
        xor     a5,s2,a5
        andi    a5,a5,0xff
        xor     a5,s1,a5
        andi    a4,a5,0xff
        lw      a3,-36(s0)
        lw      a5,-20(s0)
        slli    a5,a5,2
        add     a5,a3,a5
        sb      a4,3(a5)
        lw      a5,-20(s0)
        addi    a5,a5,1
        sw      a5,-20(s0)
.L27:
        lw      a4,-20(s0)
        li      a5,3
        ble     a4,a5,.L28
        nop
        nop
        lw      ra,44(sp)
        lw      s0,40(sp)
        lw      s1,36(sp)
        lw      s2,32(sp)
        addi    sp,sp,48
        jr      ra
InvSubBytes:
        addi    sp,sp,-48
        sw      s0,44(sp)
        addi    s0,sp,48
        sw      a0,-36(s0)
        sb      zero,-17(s0)
        j       .L30
.L33:
        sb      zero,-18(s0)
        j       .L31
.L32:
        lbu     a4,-18(s0)
        lbu     a5,-17(s0)
        lw      a3,-36(s0)
        slli    a4,a4,2
        add     a4,a3,a4
        add     a5,a4,a5
        lbu     a5,0(a5)
        mv      a2,a5
        lbu     a3,-18(s0)
        lbu     a5,-17(s0)
        lui     a4,%hi(rsbox)
        addi    a4,a4,%lo(rsbox)
        add     a4,a4,a2
        lbu     a4,0(a4)
        lw      a2,-36(s0)
        slli    a3,a3,2
        add     a3,a2,a3
        add     a5,a3,a5
        sb      a4,0(a5)
        lbu     a5,-18(s0)
        addi    a5,a5,1
        sb      a5,-18(s0)
.L31:
        lbu     a4,-18(s0)
        li      a5,3
        bleu    a4,a5,.L32
        lbu     a5,-17(s0)
        addi    a5,a5,1
        sb      a5,-17(s0)
.L30:
        lbu     a4,-17(s0)
        li      a5,3
        bleu    a4,a5,.L33
        nop
        nop
        lw      s0,44(sp)
        addi    sp,sp,48
        jr      ra
InvShiftRows:
        addi    sp,sp,-48
        sw      s0,44(sp)
        addi    s0,sp,48
        sw      a0,-36(s0)
        lw      a5,-36(s0)
        lbu     a5,13(a5)
        sb      a5,-17(s0)
        lw      a5,-36(s0)
        lbu     a4,9(a5)
        lw      a5,-36(s0)
        sb      a4,13(a5)
        lw      a5,-36(s0)
        lbu     a4,5(a5)
        lw      a5,-36(s0)
        sb      a4,9(a5)
        lw      a5,-36(s0)
        lbu     a4,1(a5)
        lw      a5,-36(s0)
        sb      a4,5(a5)
        lw      a5,-36(s0)
        lbu     a4,-17(s0)
        sb      a4,1(a5)
        lw      a5,-36(s0)
        lbu     a5,2(a5)
        sb      a5,-17(s0)
        lw      a5,-36(s0)
        lbu     a4,10(a5)
        lw      a5,-36(s0)
        sb      a4,2(a5)
        lw      a5,-36(s0)
        lbu     a4,-17(s0)
        sb      a4,10(a5)
        lw      a5,-36(s0)
        lbu     a5,6(a5)
        sb      a5,-17(s0)
        lw      a5,-36(s0)
        lbu     a4,14(a5)
        lw      a5,-36(s0)
        sb      a4,6(a5)
        lw      a5,-36(s0)
        lbu     a4,-17(s0)
        sb      a4,14(a5)
        lw      a5,-36(s0)
        lbu     a5,3(a5)
        sb      a5,-17(s0)
        lw      a5,-36(s0)
        lbu     a4,7(a5)
        lw      a5,-36(s0)
        sb      a4,3(a5)
        lw      a5,-36(s0)
        lbu     a4,11(a5)
        lw      a5,-36(s0)
        sb      a4,7(a5)
        lw      a5,-36(s0)
        lbu     a4,15(a5)
        lw      a5,-36(s0)
        sb      a4,11(a5)
        lw      a5,-36(s0)
        lbu     a4,-17(s0)
        sb      a4,15(a5)
        nop
        lw      s0,44(sp)
        addi    sp,sp,48
        jr      ra
Cipher:
        addi    sp,sp,-48
        sw      ra,44(sp)
        sw      s0,40(sp)
        addi    s0,sp,48
        sw      a0,-36(s0)
        sw      a1,-40(s0)
        sb      zero,-17(s0)
        lw      a2,-40(s0)
        lw      a1,-36(s0)
        li      a0,0
        call    AddRoundKey
        li      a5,1
        sb      a5,-17(s0)
.L38:
        lw      a0,-36(s0)
        call    SubBytes
        lw      a0,-36(s0)
        call    ShiftRows
        lbu     a4,-17(s0)
        li      a5,10
        beq     a4,a5,.L40
        lw      a0,-36(s0)
        call    MixColumns
        lbu     a5,-17(s0)
        lw      a2,-40(s0)
        lw      a1,-36(s0)
        mv      a0,a5
        call    AddRoundKey
        lbu     a5,-17(s0)
        addi    a5,a5,1
        sb      a5,-17(s0)
        j       .L38
.L40:
        nop
        lw      a2,-40(s0)
        lw      a1,-36(s0)
        li      a0,10
        call    AddRoundKey
        nop
        lw      ra,44(sp)
        lw      s0,40(sp)
        addi    sp,sp,48
        jr      ra
InvCipher:
        addi    sp,sp,-48
        sw      ra,44(sp)
        sw      s0,40(sp)
        addi    s0,sp,48
        sw      a0,-36(s0)
        sw      a1,-40(s0)
        sb      zero,-17(s0)
        lw      a2,-40(s0)
        lw      a1,-36(s0)
        li      a0,10
        call    AddRoundKey
        li      a5,9
        sb      a5,-17(s0)
.L44:
        lw      a0,-36(s0)
        call    InvShiftRows
        lw      a0,-36(s0)
        call    InvSubBytes
        lbu     a5,-17(s0)
        lw      a2,-40(s0)
        lw      a1,-36(s0)
        mv      a0,a5
        call    AddRoundKey
        lbu     a5,-17(s0)
        beq     a5,zero,.L46
        lw      a0,-36(s0)
        call    InvMixColumns
        lbu     a5,-17(s0)
        addi    a5,a5,-1
        sb      a5,-17(s0)
        j       .L44
.L46:
        nop
        nop
        lw      ra,44(sp)
        lw      s0,40(sp)
        addi    sp,sp,48
        jr      ra
AES_ECB_encrypt:
        addi    sp,sp,-32
        sw      ra,28(sp)
        sw      s0,24(sp)
        addi    s0,sp,32
        sw      a0,-20(s0)
        sw      a1,-24(s0)
        lw      a5,-20(s0)
        mv      a1,a5
        lw      a0,-24(s0)
        call    Cipher
        nop
        lw      ra,28(sp)
        lw      s0,24(sp)
        addi    sp,sp,32
        jr      ra
AES_ECB_decrypt:
        addi    sp,sp,-32
        sw      ra,28(sp)
        sw      s0,24(sp)
        addi    s0,sp,32
        sw      a0,-20(s0)
        sw      a1,-24(s0)
        lw      a5,-20(s0)
        mv      a1,a5
        lw      a0,-24(s0)
        call    InvCipher
        nop
        lw      ra,28(sp)
        lw      s0,24(sp)
        addi    sp,sp,32
        jr      ra
XorWithIv:
        addi    sp,sp,-48
        sw      s0,44(sp)
        addi    s0,sp,48
        sw      a0,-36(s0)
        sw      a1,-40(s0)
        sb      zero,-17(s0)
        j       .L50
.L51:
        lbu     a5,-17(s0)
        lw      a4,-36(s0)
        add     a5,a4,a5
        lbu     a3,0(a5)
        lbu     a5,-17(s0)
        lw      a4,-40(s0)
        add     a5,a4,a5
        lbu     a4,0(a5)
        lbu     a5,-17(s0)
        lw      a2,-36(s0)
        add     a5,a2,a5
        xor     a4,a3,a4
        andi    a4,a4,0xff
        sb      a4,0(a5)
        lbu     a5,-17(s0)
        addi    a5,a5,1
        sb      a5,-17(s0)
.L50:
        lbu     a4,-17(s0)
        li      a5,15
        bleu    a4,a5,.L51
        nop
        nop
        lw      s0,44(sp)
        addi    sp,sp,48
        jr      ra
AES_CBC_encrypt_buffer:
        addi    sp,sp,-48
        sw      ra,44(sp)
        sw      s0,40(sp)
        addi    s0,sp,48
        sw      a0,-36(s0)
        sw      a1,-40(s0)
        sw      a2,-44(s0)
        lw      a5,-36(s0)
        addi    a5,a5,176
        sw      a5,-24(s0)
        sw      zero,-20(s0)
        j       .L53
.L54:
        lw      a1,-24(s0)
        lw      a0,-40(s0)
        call    XorWithIv
        lw      a5,-36(s0)
        mv      a1,a5
        lw      a0,-40(s0)
        call    Cipher
        lw      a5,-40(s0)
        sw      a5,-24(s0)
        lw      a5,-40(s0)
        addi    a5,a5,16
        sw      a5,-40(s0)
        lw      a5,-20(s0)
        addi    a5,a5,16
        sw      a5,-20(s0)
.L53:
        lw      a4,-20(s0)
        lw      a5,-44(s0)
        bltu    a4,a5,.L54
        lw      a5,-36(s0)
        addi    a5,a5,176
        li      a2,16
        lw      a1,-24(s0)
        mv      a0,a5
        call    memcpy
        nop
        lw      ra,44(sp)
        lw      s0,40(sp)
        addi    sp,sp,48
        jr      ra
AES_CBC_decrypt_buffer:
        addi    sp,sp,-64
        sw      ra,60(sp)
        sw      s0,56(sp)
        addi    s0,sp,64
        sw      a0,-52(s0)
        sw      a1,-56(s0)
        sw      a2,-60(s0)
        sw      zero,-20(s0)
        j       .L56
.L57:
        lw      a4,-56(s0)
        addi    a5,s0,-36
        mv      a3,a4
        li      a4,16
        mv      a2,a4
        mv      a1,a3
        mv      a0,a5
        call    memcpy
        lw      a5,-52(s0)
        mv      a1,a5
        lw      a0,-56(s0)
        call    InvCipher
        lw      a5,-52(s0)
        addi    a5,a5,176
        mv      a1,a5
        lw      a0,-56(s0)
        call    XorWithIv
        lw      a5,-52(s0)
        addi    a5,a5,176
        mv      a3,a5
        addi    a5,s0,-36
        li      a4,16
        mv      a2,a4
        mv      a1,a5
        mv      a0,a3
        call    memcpy
        lw      a5,-56(s0)
        addi    a5,a5,16
        sw      a5,-56(s0)
        lw      a5,-20(s0)
        addi    a5,a5,16
        sw      a5,-20(s0)
.L56:
        lw      a4,-20(s0)
        lw      a5,-60(s0)
        bltu    a4,a5,.L57
        nop
        nop
        lw      ra,60(sp)
        lw      s0,56(sp)
        addi    sp,sp,64
        jr      ra
AES_CTR_xcrypt_buffer:
        addi    sp,sp,-64
        sw      ra,60(sp)
        sw      s0,56(sp)
        addi    s0,sp,64
        sw      a0,-52(s0)
        sw      a1,-56(s0)
        sw      a2,-60(s0)
        sw      zero,-20(s0)
        li      a5,16
        sw      a5,-24(s0)
        j       .L59
.L66:
        lw      a4,-24(s0)
        li      a5,16
        bne     a4,a5,.L60
        lw      a5,-52(s0)
        addi    a4,a5,176
        addi    a5,s0,-40
        mv      a3,a4
        li      a4,16
        mv      a2,a4
        mv      a1,a3
        mv      a0,a5
        call    memcpy
        lw      a4,-52(s0)
        addi    a5,s0,-40
        mv      a1,a4
        mv      a0,a5
        call    Cipher
        li      a5,15
        sw      a5,-24(s0)
        j       .L61
.L65:
        lw      a4,-52(s0)
        lw      a5,-24(s0)
        add     a5,a4,a5
        lbu     a4,176(a5)
        li      a5,255
        bne     a4,a5,.L62
        lw      a4,-52(s0)
        lw      a5,-24(s0)
        add     a5,a4,a5
        sb      zero,176(a5)
        j       .L67
.L62:
        lw      a4,-52(s0)
        lw      a5,-24(s0)
        add     a5,a4,a5
        lbu     a5,176(a5)
        addi    a5,a5,1
        andi    a4,a5,0xff
        lw      a3,-52(s0)
        lw      a5,-24(s0)
        add     a5,a3,a5
        sb      a4,176(a5)
        j       .L64
.L67:
        lw      a5,-24(s0)
        addi    a5,a5,-1
        sw      a5,-24(s0)
.L61:
        lw      a5,-24(s0)
        bge     a5,zero,.L65
.L64:
        sw      zero,-24(s0)
.L60:
        lw      a4,-56(s0)
        lw      a5,-20(s0)
        add     a5,a4,a5
        lbu     a3,0(a5)
        lw      a5,-24(s0)
        addi    a5,a5,-16
        add     a5,a5,s0
        lbu     a4,-24(a5)
        lw      a2,-56(s0)
        lw      a5,-20(s0)
        add     a5,a2,a5
        xor     a4,a3,a4
        andi    a4,a4,0xff
        sb      a4,0(a5)
        lw      a5,-20(s0)
        addi    a5,a5,1
        sw      a5,-20(s0)
        lw      a5,-24(s0)
        addi    a5,a5,1
        sw      a5,-24(s0)
.L59:
        lw      a4,-20(s0)
        lw      a5,-60(s0)
        bltu    a4,a5,.L66
        nop
        nop
        lw      ra,60(sp)
        lw      s0,56(sp)
        addi    sp,sp,64
        jr      ra